<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>so retro</title>

  <link href="https://fonts.googleapis.com/css2?family=Tahoma&family=Trebuchet+MS&display=swap" rel="stylesheet">

  <style>
    /*
      ==========================================================================
      GLOBAL STYLES & LAYOUT
      ==========================================================================
    */
    :root {
      --blue-main: #245edb;
      --blue-dark: #0a246a;
      --xp-window-bg: #ece9d8;
      --xp-window-border-light: #fff;
      --xp-window-border-dark: #000;
      --start-menu-bg: #ece9d8;
      --start-menu-border: #7f7f7f;
      --green-start-hover: #316ac5;
      --red-turn-off: #b32a2a;
      --orange-logoff: #e69317;
      --xp-font-main: "Tahoma", sans-serif;
      --xp-font-title: "Trebuchet MS", sans-serif;
    }

    html, body {
      height: 100%;
      margin: 0;
      font-family: var(--xp-font-main);
      overflow: hidden;
      background-color: #000;
    }

    /*
      ==========================================================================
      LOGIN & SHUTDOWN SCREENS
      ^ thanks chat gpt
      ==========================================================================
    */
    #login-screen, #shutdown-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      transition: opacity 1s ease-in-out;
      z-index: 10000;
    }

    #login-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .crt-effect {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
      background-size: 100% 2px, 3px 100%;
      pointer-events: none;
      opacity: 0.75; /* CHANGED: CRT effect made more intense - also thanks for this gemini */
      z-index: 1;
    }

    /* Windows XP Welcome Screen Specific Styles */
    #login-welcome {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, #004d9b, #007bff);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        z-index: 1001;
    }

    .login-container {
        width: 60%;
        max-width: 600px;
        background-color: #e6e6e6;
        border-radius: 10px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }

    .login-header {
        width: 100%;
        background: linear-gradient(to right, #4a8cd4, #004d9b);
        color: white;
        padding: 5px 15px;
        border-radius: 8px 8px 0 0;
        box-sizing: border-box;
        display: flex;
        align-items: center;
    }

    .login-header h1 {
        font-family: var(--xp-font-title);
        font-size: 20px;
        font-weight: bold;
        margin: 0;
        flex-grow: 1;
        text-align: center;
    }

    .login-body {
        width: 100%;
        padding: 20px;
        background-color: #ece9d8;
        border-radius: 0 0 8px 8px;
        box-sizing: border-box;
        text-align: center;
    }

    .login-user-list {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 20px;
    }

    .login-user {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
        padding: 10px;
        border: 1px solid transparent;
        transition: all 0.2s ease;
        margin: 0 10px;
    }
    
    .login-user:hover {
        background-color: #d7e0f3;
        border: 1px solid #7f9ec3;
    }

    .login-user img {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        border: 2px solid white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .login-user span {
        font-size: 14px;
        margin-top: 5px;
        color: #000;
    }

    .turn-off-btn {
        display: flex;
        align-items: center;
        background-color: #b32a2a;
        color: white;
        padding: 8px 15px;
        border: 1px solid #8e1e1e;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 20px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    
    .turn-off-btn img {
        width: 24px;
        height: 24px;
        margin-right: 8px;
    }

    /*
      ==========================================================================
      DESKTOP
      ==========================================================================
    */
    #desktop {
      position: relative;
      width: 100%;
      height: 100%;
      background: url('XP.png') no-repeat center center;
      background-size: cover;
      display: block;
      opacity: 0;
      transition: opacity 1s ease-in-out;
      z-index: 0;
    }

    #desktop.visible {
      opacity: 1;
    }
    
    .desktop-icon {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      margin: 10px;
      cursor: pointer;
      width: 80px;
      transition: background-color 0.1s ease-in-out;
      user-select: none;
    }

    .desktop-icon:hover {
      background-color: rgba(60, 120, 255, 0.45);
      border: 1px dashed rgba(255,255,255,0.7);
    }
    
    .desktop-icon img {
      width: 48px;
      height: 48px;
      pointer-events: none;
    }
    
    .desktop-icon span {
      color: white;
      text-shadow: 1px 1px 2px #000;
      font-size: 12px;
      pointer-events: none;
    }

    /*
      ==========================================================================
      TASKBAR
      ==========================================================================
    */
    #taskbar {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 28px;
      background: linear-gradient(to bottom, #7296da, #3457a4);
      border-top: 1px solid #102e60;
      display: flex;
      align-items: center;
      z-index: 500;
      padding: 0 5px;
      box-sizing: border-box;
    }
    
    .taskbar-top-lip {
      position: absolute;
      top: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(to right, #ffffff, #d8e5f2, #ffffff);
      opacity: 0.8;
    }

    #start-btn {
      width: 80px;
      height: 28px;
      border: 1px solid transparent;
      border-radius: 5px;
      cursor: pointer;
      position: relative;
      background: url('winxp.png') no-repeat center center;
      background-size: cover;
    }
    
    #start-btn:hover {
      background-color: rgba(255,255,255,0.2);
    }

    #taskbar-apps {
      flex-grow: 1;
      display: flex;
      height: 100%;
      margin-left: 10px;
    }

    .taskbar-app-icon {
      background: linear-gradient(to top, #c4d7ed, #e6f0fa);
      border: 1px solid #003366;
      border-right: 1px solid #c4d7ed;
      border-bottom: 1px solid #c4d7ed;
      display: flex;
      align-items: center;
      padding: 2px 8px;
      margin: 2px 3px;
      cursor: pointer;
      font-size: 12px;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
      max-width: 150px;
    }

    .taskbar-app-icon img {
      margin-right: 5px;
    }
    
    .taskbar-app-icon.active {
      background: linear-gradient(to bottom, #c4d7ed, #e6f0fa);
      border-top: 1px solid #c4d7ed;
      border-left: 1px solid #c4d7ed;
      border-right: 1px solid #003366;
      border-bottom: 1px solid #003366;
    }

    #system-tray {
      display: flex;
      align-items: center;
      height: 100%;
      padding-right: 5px;
      border-left: 1px solid #102e60;
      background-color: #316ac5;
    }
    
    #system-tray .tray-icon {
      width: 16px;
      height: 16px;
      margin: 0 4px;
    }

    #clock {
      padding: 2px 5px;
      font-size: 11px;
      color: white;
      border: 1px solid #316ac5;
      background-color: #5587e6;
      border-radius: 3px;
    }

    /*
      ==========================================================================
      START MENU
      ==========================================================================
    */
    #start-menu {
      position: absolute;
      bottom: 28px;
      left: 0;
      width: 300px;
      background-color: var(--start-menu-bg);
      border: 1px solid var(--start-menu-border);
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      display: flex;
      z-index: 600;
      transform-origin: bottom left;
      animation: start-menu-open 0.2s ease-out;
    }
    
    @keyframes start-menu-open {
      from { transform: scale(0.1); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    #start-menu.hidden {
      display: none;
    }

    .start-menu-left-col {
      width: 150px;
      background: var(--blue-dark);
      border-radius: 10px 0 0 10px;
      padding: 10px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: white;
    }

    .start-menu-user {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .start-menu-user img {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 2px solid white;
    }

    .start-menu-user span {
      margin-left: 10px;
      font-family: var(--xp-font-title);
      font-weight: bold;
    }

    .start-menu-entry {
      width: 95%;
      display: flex;
      align-items: center;
      padding: 5px;
      margin-bottom: 5px;
      border: 1px solid transparent;
      cursor: pointer;
      font-size: 14px;
    }
    
    .start-menu-entry:hover {
      background-color: var(--green-start-hover);
      color: white;
      border-color: #316ac5;
    }

    .start-menu-entry img {
      width: 20px;
      height: 20px;
      margin-right: 10px;
    }

    .start-menu-right-col {
      flex-grow: 1;
      padding: 10px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .start-menu-right-col .start-menu-entry {
      width: auto;
      margin-right: 0;
    }

    .start-menu-logoff-shutdown {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      padding-top: 10px;
      border-top: 1px solid #ccc;
    }

    .logoff-shutdown-btn {
      display: flex;
      align-items: center;
      padding: 5px 10px;
      border: 1px solid #aaa;
      border-radius: 5px;
      margin-left: 5px;
      cursor: pointer;
      font-size: 12px;
    }

    .logoff-shutdown-btn img {
      width: 20px;
      height: 20px;
      margin-right: 5px;
    }
    
    #logoff-btn {
      background-color: var(--orange-logoff);
      color: white;
      box-shadow: 0 0 10px var(--orange-logoff);
    }
    
    #logoff-btn:hover {
      box-shadow: 0 0 20px var(--orange-logoff);
    }

    #shutdown-btn {
      background-color: var(--red-turn-off);
      color: white;
      box-shadow: 0 0 10px var(--red-turn-off);
    }
    
    #shutdown-btn:hover {
      box-shadow: 0 0 20px var(--red-turn-off);
    }

    /*
      ==========================================================================
      WINDOWS
      ==========================================================================
    */
    .xp-window {
      position: absolute;
      background-color: var(--xp-window-bg);
      border-width: 1px 2px 2px 1px;
      border-style: solid;
      border-color: var(--xp-window-border-light) var(--xp-window-border-dark) var(--xp-window-border-dark) var(--xp-window-border-light);
      box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
      border-radius: 5px;
      min-width: 200px;
      min-height: 100px;
      overflow: hidden;
      z-index: 10;
      animation: window-open 0.3s ease-out;
    }

    /* CHANGED: Added fixed width for Jukebox for reliable positioning */
    #window-Jukebox {
        width: 260px;
    }

    .xp-window.closed {
      animation: window-close 0.3s ease-in forwards;
    }
    
    @keyframes window-open {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    @keyframes window-close {
      from { transform: scale(1); opacity: 1; }
      to { transform: scale(0.8); opacity: 0; }
    }
    
    .window-titlebar {
      height: 25px;
      background: linear-gradient(to right, #0a246a, #a6caf0);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-left: 5px;
      cursor: move;
      color: white;
      font-family: var(--xp-font-title);
      font-weight: bold;
    }

    .window-buttons {
      display: flex;
    }
    
    .window-button {
      width: 25px;
      height: 25px;
      background-color: #f0f0f0;
      border: 1px solid #7f7f7f;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .window-button img {
      width: 16px;
      height: 16px;
    }
    
    .window-button:hover {
      background-color: #d7e0f3;
    }

    .window-button.close:hover {
      background-color: #ff5454;
    }

    .window-content {
      padding: 10px;
      overflow-y: auto;
      height: calc(100% - 25px);
      box-sizing: border-box;
    }
    
    .window-content img, .window-content iframe {
      display: block;
      margin: 0 auto;
      max-width: 100%;
    }

    #window-drag-preview {
      position: absolute;
      border: 2px dashed #333;
      pointer-events: none;
      z-index: 9999;
      display: none;
    }
    
    /* Jukebox Styles */
    #jukebox-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      font-size: 0.9rem;
      font-weight: bold;
    }

    .jukebox-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .jukebox-song img {
      width: 35px;
      height: 35px;
      border-radius: 8px;
      object-fit: cover;
    }

    .jukebox-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .jukebox-controls button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: #2196f3;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow: 0 0 10px #2196f3;
      transition: transform 0.2s, background 0.2s;
    }

    .jukebox-controls button:hover {
      background: #42a5f5;
      transform: scale(1.1);
    }
    
    .volume-container {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .volume-container input[type="range"] {
      flex: 1;
    }

    /* Browser styles */
    #browser-content {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 10px;
      padding: 10px;
      overflow-y: auto;
    }
    
    #browser-content img {
      width: 100%;
      height: auto;
      cursor: pointer;
    }

    /* "You Are An Idiot" Virus Window Styles */
    .idiot-window {
      position: absolute;
      width: 300px;
      height: 200px;
      background-color: black;
      color: white;
      border: 2px solid white;
      overflow: hidden;
      z-index: 900;
      text-align: center;
      display: flex; /* CHANGED: Added flex for easy centering */
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .idiot-window-content {
      font-size: 24px;
      font-weight: bold;
      animation: color-flash 0.5s infinite;
    }
    
    @keyframes color-flash {
      0%, 100% { color: white; background: black; }
      50% { color: black; background: white; }
    }
    
  </style>
</head>
<body>

  <div id="login-screen">
    <div id="login-welcome">
        <h1 style="font-family: var(--xp-font-title); font-size: 4em; font-weight: bold; margin-bottom: 20px;">Welcome</h1>
        <div class="login-container">
            <div class="login-header">
                <h1>Click your user name to begin</h1>
            </div>
            <div class="login-body">
                <div class="login-user-list">
                    <div class="login-user" onclick="attemptLogin()">
                        <img src="alex.png" alt="User">
                        <span>alex</span>
                    </div>
                </div>
                <button class="turn-off-btn" onclick="shutdownSequence()">
                    <img src="13.png" alt="Turn Off">
                    Turn Off Computer
                </button>
            </div>
        </div>
    </div>
  </div>

  <div id="shutdown-screen" style="display: none;">
    <p style="font-size: 2em;">Shutting down...</p>
  </div>

  <div id="desktop">
    <div class="crt-effect"></div>

    <div class="desktop-icon" data-title="Bio" style="top: 20px; left: 20px;">
      <img src="1.png" alt="Bio">
      <span>Bio</span>
    </div>
    <div class="desktop-icon" data-title="Interests" style="top: 120px; left: 20px;">
      <img src="2.png" alt="Interests">
      <span>Interests</span>
    </div>
    <div class="desktop-icon" data-title="DNI" style="top: 220px; left: 20px;">
      <img src="3.png" alt="DNI">
      <span>DNI</span>
    </div>
    <div class="desktop-icon" data-title="Journal" style="top: 320px; left: 20px;">
      <img src="4.png" alt="Journal">
      <span>Journal</span>
    </div>
    <div class="desktop-icon" data-title="Drawings" style="top: 20px; left: 120px;">
      <img src="5.png" alt="Drawings">
      <span>Drawings</span>
    </div>
    <div class="desktop-icon" data-title="Games" style="top: 120px; left: 120px;">
      <img src="6.png" alt="Games">
      <span>Games</span>
    </div>
    <div class="desktop-icon" data-title="My Computer" style="top: 220px; left: 120px;">
      <img src="8.png" alt="My Computer">
      <span>My Computer</span>
    </div>
    <div class="desktop-icon" data-title="Recycle Bin" style="top: 320px; left: 120px;">
      <img src="7.png" alt="Recycle Bin">
      <span>Recycle Bin</span>
    </div>
  </div>

  <div id="taskbar">
    <div class="taskbar-top-lip"></div>
    <button id="start-btn" onclick="toggleStartMenu()"></button>
    <div id="taskbar-apps"></div>
    <div id="system-tray">
      <div id="notification-area"></div>
      <div id="clock"></div>
    </div>
  </div>

  <div id="start-menu" class="hidden">
    <div class="start-menu-left-col">
      <div class="start-menu-user">
        <img src="alex.png" alt="User">
        <span>alex</span>
      </div>
      <div class="start-menu-entries">
        <div class="start-menu-entry" onclick="openWindow('Bio', 1); toggleStartMenu();">
          <img src="1.png" alt="Bio">
          <span>Bio</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('Interests', 2); toggleStartMenu();">
          <img src="2.png" alt="Interests">
          <span>Interests</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('DNI', 3); toggleStartMenu();">
          <img src="3.png" alt="DNI">
          <span>DNI</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('Journal', 4); toggleStartMenu();">
          <img src="4.png" alt="Journal">
          <span>Journal</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('Drawings', 5); toggleStartMenu();">
          <img src="5.png" alt="Drawings">
          <span>Drawings</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('Games', 6); toggleStartMenu();">
          <img src="6.png" alt="Games">
          <span>Games</span>
        </div>
      </div>
    </div>
    <div class="start-menu-right-col">
      <div>
        <div class="start-menu-entry" onclick="openWindow('My Computer', 8); toggleStartMenu();">
          <img src="8.png" alt="My Computer">
          <span>My Computer</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('Jukebox', 10); toggleStartMenu();">
          <img src="10.png" alt="Jukebox">
          <span>Jukebox</span>
        </div>
        <div class="start-menu-entry" onclick="openWindow('Browser', 12); toggleStartMenu();">
          <img src="12.png" alt="Browser">
          <span>Browser</span>
        </div>
      </div>
      <div class="start-menu-logoff-shutdown">
        <button id="logoff-btn" class="logoff-shutdown-btn" onclick="logOff()">
          <img src="14.png" alt="Log Off">
          Log Off
        </button>
        <button id="shutdown-btn" class="logoff-shutdown-btn" onclick="shutdownSequence()">
          <img src="13.png" alt="Shutdown">
          Turn Off Computer
        </button>
      </div>
    </div>
  </div>

  <div id="window-drag-preview"></div>

  <audio id="bg-music"></audio>
  <audio id="startup-sound" src="alex/XPstartup.mp3"></audio>
  <audio id="shutdown-sound" src="alex/XPshutdown.mp3"></audio>

  <script>
    /*
      ==========================================================================
      JAVASCRIPT LOGIC
      ==========================================================================
    */

    // --- Core UI elements ---
    const loginScreen = document.getElementById('login-screen');
    const loginWelcome = document.getElementById('login-welcome');
    const desktop = document.getElementById('desktop');
    const shutdownScreen = document.getElementById('shutdown-screen');
    const startMenu = document.getElementById('start-menu');
    const taskbarApps = document.getElementById('taskbar-apps');
    const clock = document.getElementById('clock');
    const dragPreview = document.getElementById('window-drag-preview');

    // --- Audio Elements ---
    const jukeboxAudio = document.getElementById('bg-music');
    const startupSound = document.getElementById('startup-sound');
    const shutdownSound = document.getElementById('shutdown-sound');

    // --- State variables ---
    let openWindows = {};
    let zIndexCounter = 100;

    // --- Jukebox songs data ---
    const songs = [ /* CHANGED: Updated placeholder icons */
      { file: "Music1.mp3", credit: "SPAWN - Evan Fong", icon: "Music1.jpg" },
      { file: "Music2.mp3", credit: "Vapor Buster - Deltarune Chapter 3 + 4 - Toby Fox", icon: "Music2.jpg" },
      { file: "Music3.mp3", credit: "Fireplace - Deltarune Chapter 3 + 4 - Toby Fox", icon: "Music3.jpg" },
      { file: "Music4.mp3", credit: "Air Waves - Deltarune Chapter 3 + 4 - Toby Fox", icon: "Music4.jpg" },
      { file: "Music5.mp3", credit: "Home Sweet Grave - Arc System Works - GUILTY GEAR SOUND COMPLETE BOX (7)", icon: "Music5.jpg" },
      { file: "Music6.mp3", credit: "Don't Preheat your Oven Because if you do the Song Won't Play - ClascyJitto - Pizza Tower", icon: "Music6.jpg" },
      { file: "Music7.mp3", credit: "BLOODY STREAM - Coda - JJBA", icon: "Music7.jpg" },
      { file: "Music8.mp3", credit: "growing on me - snayk", icon: "Music8.jpg" }
    ];
    let currentSongIndex = 0;

    // --- App content data ---
    const windowContent = {
      'Bio': `<p>hi, thanks for opening my page and stuff,,,,,</p><p>my names alex, im 16 (feb 21, 2009) uhhh yea. this website is a personal project to practice my HTML, CSS, and JavaScript with the help of openai and gemini cause im batshit stupid,</p><p>i might add some more stuff here some other time, but for now i hope you like it.</p><p>but this was a site i made as a replacement straw page for my friends :)</p>`,
      'Interests': `<div class="window-entry"><p>i like playing games, especially sandbox and pvp games. i also enjoy drawing and programming. i listen to music and stuff, or call my girlfriend cause shes sweet</p></div>`,
      'DNI': `<p>if you are older than me by about ~3 ish years dont expect me to be super comfortable around you unless i know you</p><p>but i also dont like heavy racist stuff (stupid instagram reels are ok.)</p><p>also grown people in general make me uncomfortable if i dont know them</p><p>and im a huge g(j)ermaphobe and i hate anything like blood, mucus, etc. it just makes me a little uneasy but i wont scream from it.`,
      'Journal': `<textarea id="journal-text-area" placeholder="haha u thought this was MY journal, NONONO, this is YOURS"></textarea>`,
      'Drawings': `<p>heres some stuff i draw/drew</p><img src="15.png" alt="Drawing 1"><img src="16.png" alt="Drawing 2">`,
      'Games': `<p>i play these games:</p><ul><li>roblox</li><li>minecraft</li><li>terraria (sometimes)</li><li>stardew valley</li><li>ultrakill</li><li>gow:r</li><li>any multiplayer sandbox game pretty much.</li></ul><p>i don't play these games:</p><ul><li>fortnite</li><li>cod</li><li>overwatch</li><li>valorant</li><li>practically any fps game that is massively multiplayer, i dont play.</li></ul><p>things i frequent:</p><ul><li>roblox</li><li>discord</li></ul>`,
      'My Computer': `<p>i forgot to put something here, uh ohhhh.... (what would i put here anyways?)</p>`,
      'Recycle Bin': `<p>guys, awesome bin here, i cant wait to make a rm -rf /* joke on a windows os!</p>`,
      'Browser': `
        <div id="browser-content">
          <img src="skull.gif" alt="skull" onclick="triggerIdiotVirus()">
          <img src="skull.gif" alt="skull" onclick="triggerIdiotVirus()">
          <img src="skull.gif" alt="skull" onclick="triggerIdiotVirus()">
          <img src="skull.gif" alt="skull" onclick="triggerIdiotVirus()">
          <img src="skull.gif" alt="skull" onclick="triggerIdiotVirus()">
          <img src="skull.gif" alt="skull" onclick="triggerIdiotVirus()">
        </div>
      `,
      'Jukebox': `
        <div id="jukebox-content">
          <div class="jukebox-song">
            <img id="song-icon" src="Music1.png" alt="Song Icon">
            <div id="song-info">Loading...</div>
          </div>
          <div class="jukebox-controls">
            <button onclick="prevSong()">⏮️</button>
            <button onclick="nextSong()">⏭️</button>
          </div>
          <div class="volume-container">
            <label for="volume">🔊</label>
            <input id="volume" type="range" min="0" max="1" step="0.01" value="1">
          </div>
        </div>
      `
    };

    // --- Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
      updateClock();
      setInterval(updateClock, 1000);
      startMenu.classList.add('hidden');
      setupDesktopIcons();
    });

    // --- Login & Shutdown logic ---
    function attemptLogin() {
      loginWelcome.style.opacity = '0';
      startupSound.play().catch(e => console.error("Startup sound failed:", e));;
      setTimeout(() => {
        loginScreen.classList.add('hidden');
        desktop.classList.add('visible');
        // CHANGED: Automatically open Jukebox on login, positioned top-right
        openWindow('Jukebox', 10, desktop.offsetWidth - 280, 20); 
      }, 1000);
    }

    function shutdownSequence() {
      loginScreen.style.opacity = '0';
      shutdownScreen.style.display = 'flex';
      shutdownSound.play().catch(e => console.error("Shutdown sound failed:", e));
      setTimeout(() => {
        window.location.reload();
      }, 5000);
    }

    function logOff() {
      window.location.reload();
    }
    
    // --- Taskbar & Start Menu logic ---
    function updateClock() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      clock.textContent = `${hours}:${minutes}`;
    }

    function toggleStartMenu() {
      startMenu.classList.toggle('hidden');
    }

    // --- Window logic ---
    function openWindow(title, iconNumber, initialX = 50, initialY = 50) {
      if (openWindows[title]) {
        bringToFront(openWindows[title]);
        return;
      }

      zIndexCounter++;
      const win = document.createElement('div');
      win.className = 'xp-window';
      win.style.left = `${initialX}px`;
      win.style.top = `${initialY}px`;
      win.style.zIndex = zIndexCounter;
      win.id = `window-${title.replace(/\s/g, '-')}`;

      const taskbarIcon = document.createElement('button');
      taskbarIcon.className = 'taskbar-app-icon active';
      taskbarIcon.innerHTML = `<img src="${iconNumber}.png" style="width: 16px; height: 16px;"><span>${title}</span>`;
      taskbarIcon.onclick = () => {
        if (win.style.display === 'none') {
          win.style.display = 'block';
          bringToFront(win);
        } else if (win.style.zIndex != zIndexCounter) {
          bringToFront(win);
        } else {
          win.style.display = 'none';
          taskbarIcon.classList.remove('active');
        }
      };
      taskbarApps.appendChild(taskbarIcon);
      win.taskbarIcon = taskbarIcon;
      
      const windowHtml = `
        <div class="window-titlebar">
          <span>${title}</span>
          <div class="window-buttons">
            <button class="window-button" onclick="minimizeWindow(this.parentNode.parentNode.parentNode)">
              <img src="minimize.png">
            </button>
            <button class="window-button close" onclick="closeWindow(this.parentNode.parentNode.parentNode)">
              <img src="close.png">
            </button>
          </div>
        </div>
        <div class="window-content">
          ${windowContent[title] || `<p>Content for ${title} is missing.</p>`}
        </div>
      `;
      win.innerHTML = windowHtml;
      desktop.appendChild(win);
      openWindows[title] = win;

      win.addEventListener('mousedown', () => bringToFront(win));

      if (title === 'Jukebox') {
        const volumeSlider = win.querySelector('#volume');
        volumeSlider.addEventListener('input', () => {
          jukeboxAudio.volume = volumeSlider.value;
        });
        playSong(Math.floor(Math.random() * songs.length));
      }
    }

    function closeWindow(win) {
      const title = win.id.replace('window-', '').replace(/-/g, ' ');
      win.classList.add('closed');
      if (win.taskbarIcon) win.taskbarIcon.remove();
      delete openWindows[title];
      
      if (title === 'Jukebox') {
          jukeboxAudio.pause();
          jukeboxAudio.currentTime = 0;
      }
      
      setTimeout(() => {
        if (win.parentNode) win.parentNode.removeChild(win);
      }, 300);
    }

    function minimizeWindow(win) {
      win.style.display = 'none';
      if (win.taskbarIcon) win.taskbarIcon.classList.remove('active');
    }

    function bringToFront(win) {
      zIndexCounter++;
      win.style.zIndex = zIndexCounter;
      Object.values(openWindows).forEach(w => {
          if (w.taskbarIcon) w.taskbarIcon.classList.remove('active');
      });
      if (win.taskbarIcon) win.taskbarIcon.classList.add('active');
    }

    // --- Window Drag logic ---
    let activeWindow = null;
    let offsetX, offsetY;

    function dragStart(e, win) {
      if (e.target.closest('.window-titlebar')) {
        activeWindow = win;
        bringToFront(activeWindow);
        offsetX = e.clientX - win.offsetLeft;
        offsetY = e.clientY - win.offsetTop;
        
        dragPreview.style.display = 'block';
        dragPreview.style.width = win.offsetWidth + 'px';
        dragPreview.style.height = win.offsetHeight + 'px';
        dragPreview.style.left = win.offsetLeft + 'px';
        dragPreview.style.top = win.offsetTop + 'px';

        activeWindow.style.opacity = '0.5';
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', dragEnd);
      }
    }

    function drag(e) {
      if (activeWindow) {
        const newX = e.clientX - offsetX;
        const newY = e.clientY - offsetY;
        dragPreview.style.left = newX + 'px';
        dragPreview.style.top = newY + 'px';
      }
    }

    function dragEnd() {
      if (activeWindow) {
        const newX = parseInt(dragPreview.style.left, 10);
        const newY = parseInt(dragPreview.style.top, 10);
        
        activeWindow.style.left = newX + 'px';
        activeWindow.style.top = newY + 'px';
        activeWindow.style.opacity = '1';
        
        dragPreview.style.display = 'none';
        activeWindow = null;
        document.removeEventListener('mousemove', drag);
        document.removeEventListener('mouseup', dragEnd);
      }
    }
    // --- thank god gemini did this, i had NO fucking clue what any of this meant. - alex
    // --- Desktop Icon Drag Logic ---
    let activeIcon = null;

    function setupDesktopIcons() {
      const icons = document.querySelectorAll('.desktop-icon');
      icons.forEach(icon => {
        icon.addEventListener('mousedown', (e) => {
          activeIcon = icon;
          offsetX = e.clientX - icon.offsetLeft;
          offsetY = e.clientY - icon.offsetTop;
          document.addEventListener('mousemove', dragIcon);
          document.addEventListener('mouseup', stopDragIcon);
          e.preventDefault();
        });
        icon.addEventListener('dblclick', () => {
          const title = icon.dataset.title;
          const iconImg = icon.querySelector('img');
          const iconNumber = iconImg.src.split('/').pop().replace('.png', '');
          openWindow(title, iconNumber);
        });
      });
    }

    function dragIcon(e) {
      if (activeIcon) {
        let x = e.clientX - offsetX;
        let y = e.clientY - offsetY;
        
        x = Math.max(0, Math.min(x, desktop.clientWidth - activeIcon.clientWidth));
        y = Math.max(0, Math.min(y, desktop.clientHeight - activeIcon.clientHeight - 28));

        activeIcon.style.left = x + 'px';
        activeIcon.style.top = y + 'px';
      }
    }
    
    function stopDragIcon() {
      activeIcon = null;
      document.removeEventListener('mousemove', dragIcon);
      document.removeEventListener('mouseup', stopDragIcon);
    }
    
    // --- Jukebox Logic ---
    jukeboxAudio.addEventListener("ended", nextSong);

    function playSong(index) {
        currentSongIndex = index;
        const song = songs[index];
        jukeboxAudio.src = song.file;
        jukeboxAudio.play().catch(e => console.error("Audio playback failed:", e));

        const songInfoEl = document.getElementById("song-info");
        const songIconEl = document.getElementById("song-icon");

        if (songInfoEl) songInfoEl.textContent = song.credit;
        if (songIconEl) songIconEl.src = song.icon;
    }

    function nextSong() {
        let next = (currentSongIndex + 1) % songs.length;
        playSong(next);
    }

    function prevSong() {
        let prev = (currentSongIndex - 1 + songs.length) % songs.length;
        playSong(prev);
    }
    
    // --- "You Are An Idiot" Virus Logic ---
    let idiotWindows = [];
    
    function triggerIdiotVirus() {
        // CHANGED: Prevent the virus from running if it's already active
        if (idiotWindows.length > 0) return;

        for (let i = 0; i < 6; i++) {
            createIdiotWindow();
        }

        // CHANGED: Add a timer to remove the windows after 15 seconds
        setTimeout(() => {
            idiotWindows.forEach(win => {
                if (win.parentNode) {
                    win.parentNode.removeChild(win);
                }
            });
            idiotWindows = []; // Clear the array for the next run
        }, 15000);
    }

    function createIdiotWindow() {
        zIndexCounter++;
        const win = document.createElement('div');
        win.className = 'idiot-window';
        win.style.zIndex = zIndexCounter;
        // CHANGED: Added skull.gif to the window content
        win.innerHTML = `
            <div class="idiot-window-content">You Are An Idiot</div>
            <img src="skull.gif" alt="skull" style="width: 64px; height: 64px; margin-top: 10px;">
        `;
        
        desktop.appendChild(win);
        
        const rect = desktop.getBoundingClientRect();
        
        let pos = {
            x: Math.random() * (rect.width - 300),
            y: Math.random() * (rect.height - 200 - 28)
        };
        let vel = {
            x: (Math.random() > 0.5 ? 1 : -1) * (Math.random() * 2 + 1),
            y: (Math.random() > 0.5 ? 1 : -1) * (Math.random() * 2 + 1)
        };
        
        win.style.left = pos.x + 'px';
        win.style.top = pos.y + 'px';

        const move = () => {
            // Stop moving if the element has been removed
            if (!win.parentNode) return;

            pos.x += vel.x;
            pos.y += vel.y;

            if (pos.x <= 0 || pos.x >= rect.width - 300) vel.x *= -1;
            if (pos.y <= 0 || pos.y >= rect.height - 200 - 28) vel.y *= -1;

            win.style.left = pos.x + 'px';
            win.style.top = pos.y + 'px';

            requestAnimationFrame(move);
        };
        
        move();
        idiotWindows.push(win);
    }
    
    // Make window titlebars trigger drag
    document.addEventListener('mousedown', (e) => {
      const titlebar = e.target.closest('.window-titlebar');
      if (titlebar) {
        dragStart(e, titlebar.parentNode);
      }
    });

  </script>
</body>
</html>
